# md2visio - Mermaid è½¬ Visio å·¥å…·

**[English](README.md) | ä¸­æ–‡**

![GUIç•Œé¢æˆªå›¾](https://img-cdn.ccrui.cn/2026/01/01/6956766674530.png)

è¿™æ˜¯ä¸€ä¸ªåŸºäº .NET 8 å’Œ Windows Forms çš„æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œå®ƒå¯ä»¥å°†æ‚¨ç”¨ Mermaid.js è¯­æ³•ç¼–å†™çš„å›¾è¡¨ï¼Œè½»æ¾è½¬æ¢ä¸º Microsoft Visio çš„ `.vsdx` æ ¼å¼æ–‡ä»¶ã€‚

ä¸åŸç‰ˆç›¸æ¯”ï¼Œæœ¬é¡¹ç›®æœ€å¤§çš„ç‰¹ç‚¹æ˜¯æä¾›äº†ä¸€ä¸ªç›´è§‚çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ (GUI)ï¼Œè®©ä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„æœ‹å‹ä¹Ÿèƒ½æ„‰å¿«åœ°ä½¿ç”¨ã€‚

> è½¬æ¢æ•ˆæœï¼š![ç¤ºä¾‹](https://img-cdn.ccrui.cn/2025/06/23/685831c3cd15c.png)

## ğŸ†• v1.04 æ›´æ–°å†…å®¹

- **ç±»å›¾æ”¯æŒ** (`classDiagram`) - å®Œæ•´æ”¯æŒ UML ç±»å›¾ï¼ŒåŒ…å«å…¨éƒ¨ 8 ç§å…³ç³»ç±»å‹ã€æ³¨è§£å’Œå‘½åç©ºé—´åˆ†ç»„
- **Sugiyama å¸ƒå±€ç®—æ³•** - ä¸“ä¸šçš„å±‚æ¬¡åŒ–å¸ƒå±€ï¼Œç”Ÿæˆæ¸…æ™°æ˜“è¯»çš„ç±»å›¾
- **æµç¨‹å›¾å¸ƒå±€æ”¹è¿›** - BFS æ ‘å½¢å¸ƒå±€ï¼Œç»“æ„æ›´æ¸…æ™°

## âœ¨ é¡¹ç›®ç¼˜èµ·ä¸è‡´è°¢

æœ¬é¡¹ç›®æ˜¯åœ¨ [Megre/md2visio](https://github.com/Megre/md2visio) è¿™ä¸ªä¼˜ç§€é¡¹ç›®çš„åŸºç¡€ä¸Šè¿›è¡ŒäºŒæ¬¡å¼€å‘çš„ã€‚

åŸé¡¹ç›®ä¸º Mermaid åˆ° Visio çš„è½¬æ¢æä¾›äº†å¼ºå¤§çš„æ ¸å¿ƒé€»è¾‘ï¼Œè§£å†³äº†æœ€å…³é”®çš„æŠ€æœ¯éš¾é¢˜ã€‚æˆ‘åœ¨å®ƒçš„åŸºç¡€ä¸Šï¼Œä¸»è¦åšäº†ä»¥ä¸‹å·¥ä½œï¼š
*   **å¼€å‘äº†å…¨æ–°çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ (GUI)**ï¼Œè®©æ“ä½œæ›´ç›´è§‚ã€æ›´ç®€å•ã€‚
*   **ä¿®å¤äº†è‹¥å¹²ç¨³å®šæ€§é—®é¢˜**ï¼Œä¾‹å¦‚åœ¨ç‰¹å®šæƒ…å†µä¸‹ Visio è¿›ç¨‹é—ªé€€çš„ bugã€‚
*   **ä¼˜åŒ–äº†UIå¸ƒå±€å’Œç”¨æˆ·ä½“éªŒ**ï¼Œè®©è½¯ä»¶ç”¨èµ·æ¥æ›´é¡ºæ‰‹ã€‚
*   **é‡æ„äº†éƒ¨åˆ†ä»£ç **ï¼Œä½¿å…¶æ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

åœ¨æ­¤ï¼Œç‰¹åˆ«æ„Ÿè°¢åŸä½œè€… **Megre** çš„æ°å‡ºå·¥ä½œå’Œå¼€æºè´¡çŒ®ï¼

## ğŸš€ ä¸»è¦åŠŸèƒ½

*   **å›¾å½¢åŒ–æ“ä½œ**: å‘Šåˆ«å‘½ä»¤è¡Œï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥åœ¨çª—å£é‡Œç‚¹å‡ ä¸‹é¼ æ ‡å®Œæˆã€‚
*   **æ‹–æ‹½æ”¯æŒ**: ç›´æ¥æŠŠ `.md` æ–‡ä»¶æ‹–è¿›ç¨‹åºçª—å£ï¼Œè‡ªåŠ¨åŠ è½½ã€‚
*   **å®æ—¶æ—¥å¿—**: é»‘åº•ç»¿å­—çš„æ—¥å¿—çª—å£ï¼Œå®æ—¶æ˜¾ç¤ºè½¬æ¢çš„æ¯ä¸€æ­¥ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ã€‚
*   **çµæ´»çš„è¾“å‡ºè®¾ç½®**: å¯ä»¥è‡ªç”±æŒ‡å®šè¾“å‡ºçš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶åã€‚
*   **Visio æ˜¾ç¤ºæ§åˆ¶**: ä½ å¯ä»¥é€‰æ‹©åœ¨è½¬æ¢æ—¶ï¼Œå®æ—¶çœ‹ç€ Visio çª—å£ç”»å›¾ï¼›ä¹Ÿå¯ä»¥è®©å®ƒåœ¨åå°é»˜é»˜å®Œæˆã€‚
*   **ç¯å¢ƒè‡ªæ£€**: ä¸ç¡®å®šè‡ªå·±çš„ç”µè„‘ç¯å¢ƒè¡Œä¸è¡Œï¼Ÿç‚¹ä¸€ä¸‹"æ£€æŸ¥Visio"æŒ‰é’®ï¼Œç¨‹åºä¼šå¸®ä½ åˆ¤æ–­ã€‚

## ğŸ“Š æ”¯æŒçš„ Mermaid å›¾è¡¨ç±»å‹

è¿™æ˜¯å½“å‰ç‰ˆæœ¬å¯¹ Mermaid å›¾è¡¨çš„æ”¯æŒæƒ…å†µã€‚æˆ‘ä»¬ä¼šæŒç»­åŠªåŠ›æ”¯æŒæ›´å¤šç±»å‹ï¼

| å›¾è¡¨ç±»å‹ | çŠ¶æ€ | ä¸»é¢˜æ”¯æŒ |
|---------|------|----------|
| **graph / flowchart** (æµç¨‹å›¾) | âœ… æ”¯æŒ | âœ… |
| **sequenceDiagram** (æ—¶åºå›¾) | âœ… æ”¯æŒ | âœ… |
| **classDiagram** (ç±»å›¾) | âœ… æ”¯æŒ | âœ… |
| **journey** (ç”¨æˆ·æ—…ç¨‹å›¾) | âœ… æ”¯æŒ | âœ… |
| **pie** (é¥¼å›¾) | âœ… æ”¯æŒ | âœ… |
| **packet-beta** (æ•°æ®åŒ…å›¾) | âœ… æ”¯æŒ | âœ… |
| **xychart-beta** (XYå›¾è¡¨) | âœ… æ”¯æŒ | - |
| **Configuration** (é…ç½®æŒ‡ä»¤) | âœ… æ”¯æŒ | - |
| **erDiagram** (å®ä½“å…³ç³»å›¾) | âœ… æ”¯æŒ | - |
| stateDiagram (çŠ¶æ€å›¾) | âŒ æš‚ä¸æ”¯æŒ | - |
| gantt (ç”˜ç‰¹å›¾) | âŒ æš‚ä¸æ”¯æŒ | - |
| gitGraph (Gitå›¾) | âŒ æš‚ä¸æ”¯æŒ | - |
| mindmap (è„‘å›¾) | âŒ æš‚ä¸æ”¯æŒ | - |
| timeline (æ—¶é—´è½´) | âŒ æš‚ä¸æ”¯æŒ | - |
| sankey-beta (æ¡‘åŸºå›¾) | âŒ æš‚ä¸æ”¯æŒ | - |

## ğŸ’» æŠ€æœ¯æ ˆ

*   **æ ¸å¿ƒæ¡†æ¶**: .NET 8 + C# 12
*   **ç”¨æˆ·ç•Œé¢**: Windows Forms (WinForms)
*   **æ ¸å¿ƒä¾èµ–**:
    *   **Microsoft.Office.Interop.Visio**: é€šè¿‡ COM äº’æ“ä½œä¸ Visio é€šä¿¡
    *   **YamlDotNet**: è§£æå›¾è¡¨æ ·å¼é…ç½®æ–‡ä»¶
*   **æ¶æ„æ¨¡å¼**:
    *   åˆ†å±‚æ¶æ„ (ç±»åº“ + GUI)
    *   çŠ¶æ€æœºæ¨¡å¼ (Mermaid è§£æ)
    *   æœåŠ¡å±‚æ¨¡å¼ (ConversionService)
    *   IDisposable æ¨¡å¼ (COM èµ„æºç®¡ç†)

## ğŸ› ï¸ ä½¿ç”¨æŒ‡å—

### è¾“å…¥æ–‡ä»¶æ ¼å¼

æ‚¨çš„ Markdown æ–‡ä»¶å¿…é¡»åŒ…å«ç”¨ä»£ç å—åŒ…è£¹çš„ Mermaid å›¾è¡¨ï¼š

````markdown
```mermaid
graph LR
    A[å¼€å§‹] --> B[å¤„ç†]
    B --> C[ç»“æŸ]
```
````

ä¸€ä¸ª `.md` æ–‡ä»¶å¯ä»¥åŒ…å«å¤šä¸ª Mermaid å›¾è¡¨ï¼Œæ¯ä¸ªå›¾è¡¨éƒ½ä¼šè¢«è½¬æ¢ä¸ºå•ç‹¬çš„ Visio æ–‡ä»¶ã€‚

### æ™®é€šç”¨æˆ·

1.  **ä¸‹è½½**: å‰å¾€ [Releases](https://github.com/konbakuyomu/md2visio-gui/releases) é¡µé¢ï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬ã€‚
2.  **è§£å‹**: å°†å‹ç¼©åŒ…è§£å‹åˆ°ä»»æ„ä½ç½®ã€‚
3.  **å‰ææ¡ä»¶**: ç¡®ä¿å·²å®‰è£… **Microsoft Visio** æ¡Œé¢ç‰ˆã€‚
4.  **è¿è¡Œ**: åŒå‡» `md2visio.GUI.exe` å¯åŠ¨ç¨‹åºã€‚
5.  **è½¬æ¢**: å°† `.md` æ–‡ä»¶æ‹–å…¥çª—å£ï¼Œæˆ–ç‚¹å‡»"æµè§ˆ"æŒ‰é’®é€‰æ‹©æ–‡ä»¶ã€‚

### å¼€å‘è€…

**ç¯å¢ƒè¦æ±‚**:
*   Visual Studio 2022
*   .NET 8.0 SDK
*   Microsoft Visio

**é¡¹ç›®ç»“æ„**:
```
md2visio/          # æ ¸å¿ƒé€»è¾‘åº“
â”œâ”€â”€ mermaid/       # Mermaid è§£æå™¨ (çŠ¶æ€æœºæ¨¡å¼)
â”œâ”€â”€ struc/         # å›¾å½¢æ•°æ®ç»“æ„ (AST)
â”œâ”€â”€ vsdx/          # Visio ç»˜åˆ¶å¼•æ“
â”œâ”€â”€ Api/           # å…¬å…± API æ¥å£
â””â”€â”€ default/       # æ ·å¼é…ç½®æ–‡ä»¶

md2visio.GUI/      # å›¾å½¢ç”¨æˆ·ç•Œé¢
â””â”€â”€ Services/      # æœåŠ¡å±‚

md2visio.Tests/    # å•å…ƒæµ‹è¯•
```

**ç¼–è¯‘**:
```bash
dotnet build md2visio.sln
```

**å‘å¸ƒ**:
```bash
dotnet publish md2visio.GUI -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true
```

## ğŸ“ License

MIT License

## ğŸ™ è‡´è°¢

- [Megre/md2visio](https://github.com/Megre/md2visio) - åŸå§‹é¡¹ç›®

## â­ Star è¶‹åŠ¿

[![Star History Chart](https://api.star-history.com/svg?repos=konbakuyomu/md2visio-gui&type=date&legend=top-left)](https://www.star-history.com/#konbakuyomu/md2visio-gui&type=date&legend=top-left)

